(()=>{"use strict";var e={n:t=>{var a=t&&t.__esModule?()=>t.default:()=>t;return e.d(a,{a}),a},d:(t,a)=>{for(var o in a)e.o(a,o)&&!e.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:a[o]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};const t=window.wp.element,a=window.wp.components,o=window.wp.plugins,l=window.wp.editPost,n=window.wp.apiFetch;var s=e.n(n);window.wp.domReady,window.wp.blocks,window.wp.data;const{__}=wp.i18n;(0,o.registerPlugin)("plugin-sidebar-aploblocks",{render:function(){const e=16,[o,n]=(0,t.useState)(!1),[r,c]=(0,t.useState)([]),[i,p]=(0,t.useState)({}),[d,m]=(0,t.useState)({}),[u,h]=(0,t.useState)(!1),[b,g]=(0,t.useState)([]),[w,k]=(0,t.useState)(!1),[v,f]=(0,t.useState)(0),[E,y]=(0,t.useState)(!0),[N,S]=(0,t.useState)("");function C(e,t,a){k(!0);const o="pattern"===a?r[t].id:b[t].id,l="undefined"==typeof AbortController?void 0:new AbortController;setTimeout((()=>l?.abort()),2e4),s()({path:"/aploblocks/v2/pattern",signal:l?.signal,method:"POST",data:{id:o}}).then((e=>{if(k(!1),e.resp)return n(!1),k(!1),void wp.data.dispatch("core/notices").createNotice("error","Failed to insert pattern:"+e.message,{type:"snackbar",isDismissible:!0});const t=wp.blocks.parse(e.pattern);wp.data.dispatch("core/block-editor").insertBlocks(t),wp.data.dispatch("core/notices").createNotice("success","Pattern Inserted",{type:"snackbar",isDismissible:!0})})).catch((e=>{e.name,n(!1),k(!1),wp.data.dispatch("core/notices").createNotice("error","Failed to insert pattern:"+e,{type:"snackbar",isDismissible:!0})}))}function j(e){if("category"===e.target.attributes["data-type"].value){const t=e.target.attributes["data-category"].value;m([...d].map((e=>e.id==t?{...e,active:!e.active}:e)))}else if("tag"===e.target.attributes["data-type"].value){const t=e.target.attributes["data-tag"].value;p([...i].map((e=>e.id==t?{...e,active:!e.active}:e)))}}function _(){f(e+v),M(!1,v+e)}function M(t,a){var o="?per_page="+e+(a>0?"&offset="+a:"");k(!0),t&&(k(!0),c([]),y(!0),f(0));var l="";0!==Object.keys(d).length&&d.map((e=>{e.active&&(l=l+e.id+",")})),o+=""!==l?"&aplopatterns-category="+l:"";var n="";0!==Object.keys(i).length&&i.map((e=>{e.active&&(n=n+e.id+",")})),o+=""!==n?"&aplopatterns-tag="+n:"",fetch("https://aploblocks.com/wp-json/wp/v2/aplopatterns/"+o).then((e=>e.json())).then((a=>{a.length<e&&y(!1),c(t?a:[...r,...a])})).catch((e=>console.error(e))),k(!1)}(0,t.useEffect)((()=>{o&&0===r.length&&(M(!1),fetch("https://aploblocks.com/wp-json/wp/v2/aplopatterns-tag").then((e=>e.json())).then((e=>{e.map((e=>{e.active=!1})),p(e)})).catch((e=>console.error(e))),fetch("https://aploblocks.com/wp-json/wp/v2/aplopatterns-category").then((e=>e.json())).then((e=>{e.map((e=>{e.active=!1})),m(e)})).catch((e=>console.error(e))))}),[o]),(0,t.useEffect)((()=>{u&&0===b.length&&(k(!0),fetch("https://aploblocks.com/wp-json/wp/v2/aplolayouts/?per_page="+e).then((e=>e.json())).then((e=>{g(e),k(!1)})).catch((e=>console.error(e))))}),[u]),(0,t.useEffect)((()=>{fetch("https://aploblocks.com/wp-json/wp/v2/pages/583").then((e=>e.json())).then((e=>{S(e.content.rendered)})).catch((e=>console.error(e)))}),[]);const F=wp.element.createElement,I=F("svg",{style:{fill:"#7bb9ff"},xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 100 100"},F("path",{d:"M 85.31,17 H 99.6 V 83.59 H 85.31 Z M 57.2,17 h 14.29 v 52.74 h 8.57 V 83.59 H 57.2 Z m -37.94,0 h 11.3 12.29 v 52.49 h 9.56 l 0.27,14.1 H 28.56 V 31.32 h -9.3 z M 0.1929,17 H 14.48 V 83.59 H 0.1929 Z"}));return(0,t.createElement)(t.Fragment,null,(0,t.createElement)(l.PluginSidebarMoreMenuItem,{target:"aploblocks-plugin",icon:I},__("Aploblocks Settings","aploblocks")),(0,t.createElement)(l.PluginSidebar,{name:"aploblocks-plugin",icon:I,title:"AploBlocks"},(0,t.createElement)("div",{className:"aploblocks-sidebar"},(0,t.createElement)("p",null,__("Insert patterns or page layouts directly in to the editor.  An internet connection is required.","aploblocks")),(0,t.createElement)("div",{class:"pattern-select-buttons"},(0,t.createElement)(a.Button,{variant:"secondary",onClick:()=>n(!0)},__("Browse Patterns","aploblocks")),(0,t.createElement)(a.Button,{variant:"secondary",onClick:()=>h(!0)},__("Browse Layouts","aploblocks"))),(0,t.createElement)("div",{className:"aplo-latest",dangerouslySetInnerHTML:{__html:N}})),o&&(0,t.createElement)(a.Modal,{title:__("AploBlocks Pattern Inserter","aploblocks"),isFullScreen:"true",onRequestClose:()=>n(!1)},(0,t.createElement)("p",null,__("The patterns are built using colours defined in ","aploblocks"),(0,t.createElement)("a",{href:"https://wordpress.org/themes/author/antwp9876/",target:"_blank"},"aploblocks"),__(" themes.  For aploblocks based themes these are settings that will be defined and should integrate well in to the theme.  If a colour used is not defined in the current theme it will fall back to a preset colour in the editor, indicated with a red dashed outline, and will need to be set to the desired colour to display on the frontend","aploblocks")),function(){const e=r.length,a=[];for(let o=0;o<e;o++)a.push((0,t.createElement)("div",{className:"aplo-pattern aplo-"+r[o].ptype_name},(0,t.createElement)("img",{onClick:e=>C(0,o,"pattern"),src:r[o].fimg_url})));const o=i.length,l=[];for(let e=0;e<o;e++)l.push((0,t.createElement)("a",{tabIndex:"0",className:i[e].active?"active":"",onClick:j,"data-type":"tag","data-tag":i[e].id},i[e].name));const n=d.length,s=[];for(let e=0;e<n;e++)s.push((0,t.createElement)("a",{tabIndex:"0",className:d[e].active?"active":"",onClick:j,"data-type":"category","data-category":d[e].id},d[e].name));return(0,t.createElement)(t.Fragment,null,(0,t.createElement)("div",{className:"pattern-interface"},(0,t.createElement)("div",{className:"pattern-searcher"},(0,t.createElement)("div",{className:"search-content"},(0,t.createElement)("h3",null,__("Categories","aploblocks")),(0,t.createElement)("p",null,__("Select patterns that are in any of the following categories","aploblocks")),(0,t.createElement)("div",{className:"search-param"},s),(0,t.createElement)("h3",null,__("Tags","aploblocks")),(0,t.createElement)("p",null,__("Select patterns that contain any of the following tags","aploblocks")),(0,t.createElement)("div",{className:"search-param"},l),(0,t.createElement)("div",{className:"search-buttons"},(0,t.createElement)("button",{onClick:()=>M(!0)},"Update Search"),(0,t.createElement)("button",{onClick:()=>function(){const e=[...d];e.map((e=>{e.active=!1})),m(e);const t=[...i];i.map((e=>{e.active=!1})),p(t),M(!0)}()},"Clear")))),(0,t.createElement)("div",null,(0,t.createElement)("div",{className:"patternList"},a),E&&(0,t.createElement)("div",{className:"load-more"},(0,t.createElement)("button",{onClick:()=>_(),className:"load-more-button"},__("Load More","aploblocks"))))))}(),w&&(0,t.createElement)("div",{class:"aploblocks-loading-outer"},(0,t.createElement)("div",{class:"aploblocks-pattern-loading"}))),u&&(0,t.createElement)(a.Modal,{title:__("AploBlocks Layout Inserter","aploblocks"),isFullScreen:"true",onRequestClose:()=>h(!1)},(0,t.createElement)("p",null,__("The layouts are built using colours defined in ","aploblocks"),(0,t.createElement)("a",{href:"https://wordpress.org/themes/author/antwp9876/",target:"_blank"},"aploblocks"),__(" themes.  For aploblocks based themes these are settings that will be defined and should integrate well in to the theme.  If a colour used is not defined in the current theme it will fall back to a preset colour in the editor, indicated with a red dashed outline, and will need to be set to the desired colour to display on the frontend","aploblocks")),function(){const e=b.length,a=[];for(let o=0;o<e;o++)a.push((0,t.createElement)("img",{onClick:e=>C(0,o,"layout"),src:b[o].fimg_url}));return(0,t.createElement)(t.Fragment,null,(0,t.createElement)("div",{className:"patternList"},a),(0,t.createElement)("div",{className:"load-more"},(0,t.createElement)("button",{onClick:()=>_(),className:"load-more-button"},"Load More")))}(),w&&(0,t.createElement)("div",{class:"aploblocks-loading-outer"},(0,t.createElement)("div",{class:"aploblocks-pattern-loading"})))))}})})();